<!DOCTYPE html>
<html>
<head>
    <title>üé∞ –ö–µ–π—Å—ã —Å –ø–æ–¥–∞—Ä–∫–∞–º–∏</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--tg-theme-bg-color, #f5f5f5);
            color: var(--tg-theme-text-color, #333333);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .top-bar {
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .back-button {
            font-size: 18px;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 10px;
            background: var(--tg-theme-bg-color, #f5f5f5);
            display: none;
            font-weight: 500;
        }
        
        .back-button.visible {
            display: block;
        }
        
        .balance-container {
            display: flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(145deg, #2c3e50, #3498db);
            padding: 8px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .balance-container:hover {
            transform: scale(1.05);
        }
        
        .star-icon {
            width: 30px;
            height: 30px;
            background: url('https://cdn1.tenchat.ru/static/vbc-gostinder/2025-09-21/5c565d16-168c-49e4-8b3c-6d20da018214.webp') center/contain no-repeat;
        }
        
        .balance-amount {
            color: white;
            font-size: 20px;
            font-weight: bold;
        }
        
        .content {
            flex: 1;
            padding: 20px;
            padding-bottom: 80px;
        }
        
        .section-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--tg-theme-text-color, #333);
        }
        
        .cases-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .case-card {
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 2px solid transparent;
        }
        
        .case-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
            border-color: #ffd700;
        }
        
        .case-image {
            width: 100%;
            height: 200px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 60px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            background-size: cover;
            background-position: center;
            background-image: url('https://i.postimg.cc/w3wd8bSR/image-2026-02-20-204059171.png');
        }
        
        .case-name {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .case-price {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 18px;
            color: #ffd700;
            font-weight: bold;
        }
        
        .case-price .small-star {
            width: 20px;
            height: 20px;
            background: url('https://cdn1.tenchat.ru/static/vbc-gostinder/2025-09-21/5c565d16-168c-49e4-8b3c-6d20da018214.webp') center/contain no-repeat;
        }
        
        .case-detail {
            display: none;
            animation: fadeIn 0.3s;
        }
        
        .case-detail.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .detail-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .detail-image {
            width: 200px;
            height: 200px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 80px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            background-size: cover;
            background-position: center;
            background-image: url('https://i.postimg.cc/w3wd8bSR/image-2026-02-20-204059171.png');
        }
        
        .detail-name {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .detail-price {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 24px;
            color: #ffd700;
            font-weight: bold;
        }
        
        .detail-price .star-icon {
            width: 30px;
            height: 30px;
        }
        
        .chances-section {
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .chances-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .chance-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            border-radius: 12px;
            background: var(--tg-theme-bg-color, #f5f5f5);
            margin-bottom: 10px;
        }
        
        .chance-item img {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            object-fit: contain;
        }
        
        .chance-info {
            flex: 1;
        }
        
        .chance-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .chance-bar-container {
            width: 100%;
            height: 8px;
            background: #ddd;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 2px;
        }
        
        .chance-bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            border-radius: 4px;
        }
        
        .chance-percent {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #666);
        }
        
        .chance-value {
            font-size: 18px;
            font-weight: bold;
            color: #ffd700;
            min-width: 70px;
            text-align: right;
        }
        
        .quantity-selector {
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .quantity-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .quantity-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .quantity-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid var(--tg-theme-button-color, #40a7e3);
            background: transparent;
            color: var(--tg-theme-text-color, #333);
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            max-width: 70px;
        }
        
        .quantity-btn.active {
            background: var(--tg-theme-button-color, #40a7e3);
            color: var(--tg-theme-button-text-color, #ffffff);
        }
        
        .quantity-btn:hover {
            transform: scale(1.05);
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .open-case-btn, .demo-case-btn {
            flex: 1;
            padding: 20px;
            border: none;
            border-radius: 20px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .open-case-btn {
            background: linear-gradient(145deg, #4CAF50, #45a049);
            color: white;
        }
        
        .demo-case-btn {
            background: linear-gradient(145deg, #ff9800, #f57c00);
            color: white;
        }
        
        .open-case-btn:hover, .demo-case-btn:hover {
            transform: scale(1.02);
        }
        
        .open-case-btn:disabled, .demo-case-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .total-price {
            font-size: 14px;
            background: rgba(255,255,255,0.2);
            padding: 3px 10px;
            border-radius: 20px;
        }
        
        .demo-badge {
            font-size: 12px;
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 12px;
        }
        
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .inventory-item {
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
        }
        
        .inventory-item img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 10px;
            border-radius: 10px;
        }
        
        .inventory-item-name {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .inventory-item-price {
            color: #ffd700;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .item-count {
            background: #ffd700;
            color: #333;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 8px;
        }
        
        .demo-badge-item {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #ff9800;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: bold;
        }
        
        .inventory-controls {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        
        .sell-one-btn, .sell-all-btn {
            flex: 1;
            color: white;
            border: none;
            padding: 8px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .sell-one-btn {
            background: #4CAF50;
        }
        
        .sell-all-btn {
            background: #ff9800;
        }
        
        .sell-one-btn:hover, .sell-all-btn:hover {
            transform: scale(1.05);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .roulette-container {
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            border-radius: 30px;
            padding: 20px;
            max-width: 95%;
            width: 600px;
            text-align: center;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .roulette-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .roulette-subtitle {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #666);
            margin-bottom: 15px;
        }
        
        .demo-mode {
            background: linear-gradient(145deg, #ff9800, #f57c00);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 10px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .multi-roulette {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        
        .single-roulette {
            background: linear-gradient(145deg, #1a2634, #2c3e50);
            border-radius: 10px;
            padding: 10px 0;
            position: relative;
            overflow: hidden;
            height: 100px;
            border: 2px solid #ffd700;
        }
        
        .roulette-track {
            display: flex;
            gap: 10px;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translateY(-50%);
            will-change: transform;
        }
        
        .roulette-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(255,255,255,0.15);
            padding: 5px;
            border-radius: 8px;
            min-width: 70px;
        }
        
        .roulette-item img {
            width: 40px;
            height: 40px;
            object-fit: contain;
            border-radius: 5px;
        }
        
        .roulette-item span {
            color: white;
            font-size: 10px;
            font-weight: bold;
        }
        
        .roulette-indicator {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 3px;
            background: linear-gradient(to bottom, #ff0000, #ff4444);
            transform: translateX(-50%);
            box-shadow: 0 0 10px #ff0000;
            z-index: 2;
        }
        
        .results-container {
            max-height: 250px;
            overflow-y: auto;
            margin: 15px 0;
            padding: 10px;
            background: var(--tg-theme-bg-color, #f5f5f5);
            border-radius: 15px;
        }
        
        .result-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px;
            border-radius: 10px;
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            margin-bottom: 8px;
        }
        
        .result-item.demo {
            opacity: 0.7;
            border: 2px dashed #ff9800;
        }
        
        .result-item img {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            object-fit: contain;
        }
        
        .result-item-info {
            flex: 1;
            text-align: left;
        }
        
        .result-item-name {
            font-weight: bold;
            margin-bottom: 2px;
        }
        
        .result-item-price {
            color: #ffd700;
            font-size: 14px;
        }
        
        .demo-label {
            font-size: 10px;
            background: #ff9800;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            margin-left: 10px;
        }
        
        .result-buttons {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .result-button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .result-button.sell {
            background: #4CAF50;
            color: white;
        }
        
        .result-button.again {
            background: var(--tg-theme-button-color, #40a7e3);
            color: var(--tg-theme-button-text-color, #ffffff);
        }
        
        .result-button.stars {
            background: linear-gradient(145deg, #ffd700, #ffb347);
            color: #333;
        }
        
        .result-button:hover {
            transform: scale(1.02);
        }
        
        .close-button {
            width: 100%;
            padding: 12px;
            background: none;
            border: 2px solid var(--tg-theme-hint-color, #666);
            border-radius: 12px;
            color: var(--tg-theme-hint-color, #666);
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .close-button:hover {
            background: var(--tg-theme-hint-color, #666);
            color: white;
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 99;
        }
        
        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--tg-theme-hint-color, #666);
        }
        
        .nav-item.active {
            color: var(--tg-theme-button-color, #40a7e3);
            transform: translateY(-2px);
        }
        
        .nav-icon {
            font-size: 28px;
        }
        
        .nav-label {
            font-size: 12px;
            font-weight: 500;
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .empty-section {
            text-align: center;
            padding: 50px 20px;
            font-size: 18px;
            color: var(--tg-theme-hint-color, #666);
        }
        
        .profile-stats {
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid var(--tg-theme-hint-color, #ddd);
        }
        
        .stat-item:last-child {
            border-bottom: none;
        }
        
        .stat-label {
            font-size: 16px;
            color: var(--tg-theme-hint-color, #666);
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: bold;
        }
        
        .deposit-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .deposit-option {
            background: linear-gradient(145deg, #ffd700, #ffb347);
            color: #333;
            border: none;
            padding: 15px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .deposit-option:hover {
            transform: scale(1.05);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ */
        .admin-login {
            position: fixed;
            top: 70px;
            right: 10px;
            width: 40px;
            height: 40px;
            background: rgba(255,215,0,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            z-index: 1000;
            transition: all 0.3s;
        }
        
        .admin-login:hover {
            background: rgba(255,215,0,0.4);
            transform: scale(1.1);
        }
        
        .admin-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 2000;
            overflow: hidden;
            display: none;
            flex-direction: column;
            border: 2px solid #ffd700;
        }
        
        .admin-header {
            background: linear-gradient(145deg, #2c3e50, #3498db);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .admin-header h2 {
            margin: 0;
            font-size: 24px;
        }
        
        .close-admin {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }
        
        .close-admin:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .admin-tabs {
            display: flex;
            border-bottom: 2px solid #ddd;
        }
        
        .admin-tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--tg-theme-text-color, #333);
        }
        
        .admin-tab.active {
            background: var(--tg-theme-button-color, #40a7e3);
            color: var(--tg-theme-button-text-color, #ffffff);
        }
        
        .admin-tab-content {
            display: none;
            padding: 20px;
            overflow-y: auto;
            max-height: calc(80vh - 120px);
        }
        
        .admin-tab-content.active {
            display: block;
        }
        
        .users-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid var(--tg-theme-hint-color, #ddd);
        }
        
        .user-item:last-child {
            border-bottom: none;
        }
        
        .user-name {
            font-weight: bold;
        }
        
        .user-stats {
            color: #ffd700;
        }
        
        .admin-btn {
            background: var(--tg-theme-button-color, #40a7e3);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            transition: transform 0.2s;
        }
        
        .admin-btn:hover {
            transform: scale(1.05);
        }
        
        .admin-btn.save {
            background: #4CAF50;
        }
        
        .form-group {
            margin: 15px 0;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .item-edit {
            background: var(--tg-theme-bg-color, #f5f5f5);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: var(--tg-theme-bg-color, #f5f5f5);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-label {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #666);
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #ffd700;
        }
        
        .top-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .top-item {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid var(--tg-theme-hint-color, #ddd);
        }
        
        .top-rank {
            font-weight: bold;
            color: #ffd700;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="back-button" id="backButton" onclick="showMainMenu()">‚Üê –ù–∞–∑–∞–¥</div>
        <div></div>
        <div class="balance-container" onclick="showBalanceModal()">
            <div class="star-icon"></div>
            <span class="balance-amount" id="balanceDisplay">0</span>
        </div>
    </div>

    <div class="content">
        <div id="mainMenu" class="section active">
            <h2 class="section-title">üéÅ –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–µ–π—Å—ã</h2>
            <div class="cases-grid">
                <div class="case-card" onclick="showCaseDetail('bronze')">
                    <div class="case-image"></div>
                    <div class="case-name">–ë—Ä–æ–Ω–∑–æ–≤—ã–π –∫–µ–π—Å</div>
                    <div class="case-price">
                        <div class="small-star"></div>
                        99 –∑–≤—ë–∑–¥
                    </div>
                </div>
            </div>
        </div>

        <div id="caseDetail" class="case-detail">
            <div class="detail-header">
                <div class="detail-image" id="detailImage"></div>
                <div class="detail-name" id="detailName">–ë—Ä–æ–Ω–∑–æ–≤—ã–π –∫–µ–π—Å</div>
                <div class="detail-price" id="detailPrice">
                    <div class="star-icon"></div>
                    99 –∑–≤—ë–∑–¥
                </div>
            </div>

            <div class="chances-section">
                <div class="chances-title">üìä –®–∞–Ω—Å—ã –≤—ã–ø–∞–¥–µ–Ω–∏—è</div>
                <div id="chancesList"></div>
            </div>

            <div class="quantity-selector">
                <div class="quantity-title">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç–∏–π:</div>
                <div class="quantity-buttons">
                    <button class="quantity-btn active" onclick="selectQuantity(1)">1</button>
                    <button class="quantity-btn" onclick="selectQuantity(2)">2</button>
                    <button class="quantity-btn" onclick="selectQuantity(3)">3</button>
                    <button class="quantity-btn" onclick="selectQuantity(4)">4</button>
                    <button class="quantity-btn" onclick="selectQuantity(5)">5</button>
                </div>
            </div>

            <div class="action-buttons">
                <button class="open-case-btn" onclick="openCase(false)" id="openCaseBtn">
                    <span>üí∞ –û—Ç–∫—Ä—ã—Ç—å –∑–∞ –∑–≤—ë–∑–¥—ã</span>
                    <span class="total-price" id="totalPrice">99 ‚≠ê</span>
                </button>
                <button class="demo-case-btn" onclick="openCase(true)" id="demoCaseBtn">
                    <span>üé≤ –î–µ–º–æ-–æ—Ç–∫—Ä—ã—Ç–∏–µ</span>
                    <span class="demo-badge">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                </button>
            </div>
        </div>

        <div id="gamesSection" class="section">
            <h2 class="section-title">üéÆ –ú–∏–Ω–∏-–∏–≥—Ä—ã</h2>
            <div class="empty-section">
                üöß –†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ<br>
                –°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –∏–≥—Ä—ã!
            </div>
        </div>

        <div id="profileSection" class="section">
            <h2 class="section-title">üë§ –ü—Ä–æ—Ñ–∏–ª—å</h2>
            <div class="profile-stats">
                <div class="stat-item">
                    <span class="stat-label">–û—Ç–∫—Ä—ã—Ç–æ –∫–µ–π—Å–æ–≤:</span>
                    <span class="stat-value" id="openedCases">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">–ë–∞–ª–∞–Ω—Å –∑–≤—ë–∑–¥:</span>
                    <span class="stat-value" id="profileBalance">0 ‚≠ê</span>
                </div>
            </div>
            
            <h3 style="margin: 20px 0 10px;">üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h3>
            <div id="inventory" class="inventory-grid"></div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchToCases()">
            <span class="nav-icon">üéÅ</span>
            <span class="nav-label">–ö–µ–π—Å—ã</span>
        </div>
        <div class="nav-item" onclick="switchToGames()">
            <span class="nav-icon">üéÆ</span>
            <span class="nav-label">–ò–≥—Ä—ã</span>
        </div>
        <div class="nav-item" onclick="switchToProfile()">
            <span class="nav-icon">üë§</span>
            <span class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</span>
        </div>
    </div>

    <div id="rouletteModal" class="modal">
        <div class="roulette-container">
            <div id="rouletteMode" class="demo-mode" style="display: none;">üé≤ –î–ï–ú–û-–†–ï–ñ–ò–ú</div>
            <div class="roulette-title" id="rouletteTitle">üé∞ –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–æ–≤</div>
            <div class="roulette-subtitle" id="rouletteSubtitle"></div>
            <div id="multiRoulette" class="multi-roulette"></div>
            <div id="resultsList" class="results-container"></div>
            <div id="finalButtons" style="display: none;">
                <div class="result-buttons">
                    <button class="result-button sell" id="sellButton" onclick="sellAllResults()">üí∞ –ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë</button>
                    <button class="result-button again" onclick="openAgain()">üé≤ –û—Ç–∫—Ä—ã—Ç—å –µ—â—ë</button>
                </div>
                <button class="close-button" onclick="closeRoulette()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="balanceModal" class="modal">
        <div class="roulette-container" style="max-width: 400px;">
            <div class="roulette-title">üí∞ –ë–∞–ª–∞–Ω—Å</div>
            <div style="font-size: 48px; color: #ffd700; margin: 20px 0;" id="modalBalance">0 ‚≠ê</div>
            
            <div class="deposit-options">
                <button class="deposit-option" onclick="depositStars(50)">50 ‚≠ê</button>
                <button class="deposit-option" onclick="depositStars(100)">100 ‚≠ê</button>
                <button class="deposit-option" onclick="depositStars(500)">500 ‚≠ê</button>
                <button class="deposit-option" onclick="depositStars(1000)">1000 ‚≠ê</button>
            </div>
            
            <button class="close-button" onclick="closeBalanceModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
    <div id="adminPanel" class="admin-panel">
        <div class="admin-header">
            <h2>üëë –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
            <button onclick="toggleAdminPanel()" class="close-admin">‚úñ</button>
        </div>
        
        <div class="admin-tabs">
            <button class="admin-tab active" onclick="switchAdminTab('users')">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
            <button class="admin-tab" onclick="switchAdminTab('cases')">–ö–µ–π—Å—ã</button>
            <button class="admin-tab" onclick="switchAdminTab('stats')">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
        </div>
        
        <div id="adminUsers" class="admin-tab-content active">
            <h3>üë• –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
            <div class="users-list" id="usersList"></div>
        </div>
        
        <div id="adminCases" class="admin-tab-content">
            <h3>üé≤ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ–π—Å–∞–º–∏</h3>
            
            <div class="case-editor">
                <h4>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–µ–π—Å</h4>
                <select id="caseSelector" onchange="loadCaseForEdit()">
                    <option value="bronze">–ë—Ä–æ–Ω–∑–æ–≤—ã–π –∫–µ–π—Å</option>
                </select>
                
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–µ–π—Å–∞:</label>
                    <input type="text" id="caseName" value="–ë—Ä–æ–Ω–∑–æ–≤—ã–π –∫–µ–π—Å">
                </div>
                
                <div class="form-group">
                    <label>–¶–µ–Ω–∞ (–∑–≤—ë–∑–¥):</label>
                    <input type="number" id="casePrice" value="99" min="1">
                </div>
                
                <div class="form-group">
                    <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (URL):</label>
                    <input type="text" id="caseImage" value="https://i.postimg.cc/w3wd8bSR/image-2026-02-20-204059171.png">
                </div>
                
                <h4>–ü—Ä–µ–¥–º–µ—Ç—ã –≤ –∫–µ–π—Å–µ</h4>
                <div id="itemsList"></div>
                
                <button class="admin-btn" onclick="addNewItem()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç</button>
                <button class="admin-btn save" onclick="saveCaseChanges()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </div>
        </div>
        
        <div id="adminStats" class="admin-tab-content">
            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    <div class="stat-value" id="totalUsers">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–í—Å–µ–≥–æ –æ—Ç–∫—Ä—ã—Ç–æ –∫–µ–π—Å–æ–≤</div>
                    <div class="stat-value" id="totalOpenedCases">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–í—Å–µ–≥–æ –∑–≤—ë–∑–¥ –≤ —Å–∏—Å—Ç–µ–º–µ</div>
                    <div class="stat-value" id="totalStars">0</div>
                </div>
            </div>
            
            <h4>–¢–æ–ø-10 –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä–æ–≤</h4>
            <div class="top-list" id="topUsers"></div>
        </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∞–¥–º–∏–Ω–∞ -->
    <div class="admin-login" id="adminLoginButton" onclick="promptAdminPassword()" title="–í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞">
        üë§
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // ‚ö†Ô∏è –í–ê–ñ–ù–û: –ó–î–ï–°–¨ –ù–£–ñ–ù–û –í–°–¢–ê–í–ò–¢–¨ –¢–í–û–ô –†–ï–ê–õ–¨–ù–´–ô TELEGRAM ID!
        // –£–∑–Ω–∞—Ç—å ID –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ @userinfobot
        const OWNER_ID = 7389462195; // ‚Üê –ó–ê–ú–ï–ù–ò –≠–¢–û –ß–ò–°–õ–û –ù–ê –°–í–û–ô ID!
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getUserId() {
            // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å ID —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏
            if (tg.initDataUnsafe?.user?.id) {
                return tg.initDataUnsafe.user.id;
            }
            
            // –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–∏, –ø—Ä–æ–±—É–µ–º —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å initData
            if (tg.initData) {
                try {
                    const params = new URLSearchParams(tg.initData);
                    const userStr = params.get('user');
                    if (userStr) {
                        const user = JSON.parse(userStr);
                        return user.id;
                    }
                } catch (e) {
                    console.error('Error parsing user data:', e);
                }
            }
            
            return null;
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–ª–∞–¥–µ–ª—å—Ü–µ–º
        function isOwner() {
            const userId = getUserId();
            console.log('Current user ID:', userId, 'Owner ID:', OWNER_ID); // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
            return userId && userId === OWNER_ID;
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∞–¥–º–∏–Ω–∞ —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü—É
        function updateAdminButtonVisibility() {
            const adminLogin = document.getElementById('adminLoginButton');
            if (adminLogin) {
                if (isOwner()) {
                    adminLogin.style.display = 'flex';
                    console.log('Admin button SHOWN for owner');
                } else {
                    adminLogin.style.display = 'none';
                    console.log('Admin button HIDDEN for non-owner');
                }
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        function loadState() {
            const saved = localStorage.getItem('caseGameState');
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    state.balance = parsed.balance || 0;
                    state.openedCases = parsed.openedCases || 0;
                    state.inventory = parsed.inventory || [];
                } catch (e) {
                    console.error('Error loading state:', e);
                }
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function saveState() {
            try {
                const toSave = {
                    balance: state.balance,
                    openedCases: state.openedCases,
                    inventory: state.inventory
                };
                localStorage.setItem('caseGameState', JSON.stringify(toSave));
            } catch (e) {
                console.error('Error saving state:', e);
            }
        }

        let state = {
            balance: 0,
            openedCases: 0,
            inventory: [],
            currentCase: 'bronze',
            selectedQuantity: 1,
            currentOpenings: [],
            isSpinning: false,
            isDemo: false
        };

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        loadState();

        const items = {
            calendar: {
                id: 'calendar',
                name: '–ö–∞–ª–µ–Ω–¥–∞—Ä—å',
                emoji: 'üìÖ',
                image: 'https://i.getgems.io/7Sh_kav1VknhySEnSiYNINj0huQcoW6vAH2YtwpIg-w/rs:fill:500:500:1/g:ce/czM6Ly9nZXRnZW1zLXMzL25mdC1jb250ZW50LWNhY2hlL2ltYWdlcy9FUUJNY2ZNQVpsTVVyMVczWDhrZEV3M2ZKTVVBYVdINC1YY21FNVI1UmZGSVkwRTIvODljMjViOWE2NjFhMGU3Zg',
                price: 500,
                chance: 10
            },
            rose: {
                id: 'rose',
                name: '–†–æ–∑–æ—á–∫–∞',
                emoji: 'üåπ',
                image: 'https://cdn140.picsart.com/241734929003212.png',
                price: 25,
                chance: 90
            }
        };

        const cases = {
            bronze: {
                name: '–ë—Ä–æ–Ω–∑–æ–≤—ã–π –∫–µ–π—Å',
                price: 99,
                image: 'üèÜ',
                color: 'linear-gradient(145deg, #cd7f32, #b87333)',
                items: [items.calendar, items.rose]
            }
        };

        // –í—ã–∑—ã–≤–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º
        setTimeout(updateAdminButtonVisibility, 500);
        // –¢–∞–∫–∂–µ –≤—ã–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', updateAdminButtonVisibility);

        function switchToCases() {
            document.querySelectorAll('.nav-item').forEach((item, index) => {
                item.classList.toggle('active', index === 0);
            });
            
            document.getElementById('mainMenu').classList.add('active');
            document.getElementById('gamesSection').classList.remove('active');
            document.getElementById('profileSection').classList.remove('active');
            document.getElementById('caseDetail').classList.remove('active');
            document.getElementById('backButton').classList.remove('visible');
        }

        function switchToGames() {
            document.querySelectorAll('.nav-item').forEach((item, index) => {
                item.classList.toggle('active', index === 1);
            });
            
            document.getElementById('mainMenu').classList.remove('active');
            document.getElementById('caseDetail').classList.remove('active');
            document.getElementById('gamesSection').classList.add('active');
            document.getElementById('profileSection').classList.remove('active');
            document.getElementById('backButton').classList.remove('visible');
        }

        function switchToProfile() {
            document.querySelectorAll('.nav-item').forEach((item, index) => {
                item.classList.toggle('active', index === 2);
            });
            
            document.getElementById('mainMenu').classList.remove('active');
            document.getElementById('caseDetail').classList.remove('active');
            document.getElementById('gamesSection').classList.remove('active');
            document.getElementById('profileSection').classList.add('active');
            document.getElementById('backButton').classList.remove('visible');
            renderInventory();
        }

        function showCaseDetail(caseId) {
            state.currentCase = caseId;
            const caseData = cases[caseId];
            
            document.getElementById('mainMenu').classList.remove('active');
            document.getElementById('caseDetail').classList.add('active');
            document.getElementById('backButton').classList.add('visible');
            
            document.getElementById('detailImage').innerHTML = '';
            document.getElementById('detailName').textContent = caseData.name;
            
            document.getElementById('detailPrice').innerHTML = `
                <div class="star-icon"></div>
                ${caseData.price} –∑–≤—ë–∑–¥
            `;
            
            const chancesList = document.getElementById('chancesList');
            chancesList.innerHTML = '';
            
            caseData.items.forEach(item => {
                chancesList.innerHTML += `
                    <div class="chance-item">
                        <img src="${item.image}" alt="${item.name}">
                        <div class="chance-info">
                            <div class="chance-name">${item.emoji} ${item.name}</div>
                            <div class="chance-bar-container">
                                <div class="chance-bar" style="width: ${item.chance}%"></div>
                            </div>
                            <div class="chance-percent">${item.chance}%</div>
                        </div>
                        <div class="chance-value">${item.price} ‚≠ê</div>
                    </div>
                `;
            });
            
            selectQuantity(1);
        }

        function showMainMenu() {
            document.getElementById('caseDetail').classList.remove('active');
            document.getElementById('mainMenu').classList.add('active');
            document.getElementById('backButton').classList.remove('visible');
        }

        function selectQuantity(quantity) {
            state.selectedQuantity = quantity;
            
            document.querySelectorAll('.quantity-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent == quantity) btn.classList.add('active');
            });
            
            const caseData = cases[state.currentCase];
            document.getElementById('totalPrice').innerHTML = `${caseData.price * quantity} ‚≠ê`;
        }

        function showBalanceModal() {
            document.getElementById('modalBalance').textContent = state.balance + ' ‚≠ê';
            document.getElementById('balanceModal').classList.add('active');
        }

        function closeBalanceModal() {
            document.getElementById('balanceModal').classList.remove('active');
        }

        function depositStars(amount) {
            state.balance += amount;
            updateBalance();
            saveState();
            closeBalanceModal();
            tg.showPopup({
                title: '‚úÖ –£—Å–ø–µ—à–Ω–æ!',
                message: `–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} ‚≠ê`,
                buttons: [{type: 'ok'}]
            });
        }

        function renderInventory() {
            const inventoryDiv = document.getElementById('inventory');
            
            if (state.inventory.length === 0) {
                inventoryDiv.innerHTML = '<div class="empty-section">ü´ô –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>';
                return;
            }
            
            const grouped = {};
            state.inventory.forEach(item => {
                const key = `${item.id}_${item.isDemo ? 'demo' : 'real'}`;
                if (!grouped[key]) {
                    grouped[key] = {
                        ...item,
                        items: [item]
                    };
                } else {
                    grouped[key].items.push(item);
                }
            });
            
            let html = '';
            for (let key in grouped) {
                const group = grouped[key];
                const item = group.items[0];
                const count = group.items.length;
                
                html += `
                    <div class="inventory-item">
                        ${item.isDemo ? '<div class="demo-badge-item">DEMO</div>' : ''}
                        <img src="${item.image}" alt="${item.name}">
                        <div class="inventory-item-name">${item.emoji} ${item.name}</div>
                        <div class="inventory-item-price">${item.price} ‚≠ê</div>
                        <span class="item-count">x${count}</span>
                        ${!item.isDemo ? `
                        <div class="inventory-controls">
                            <button class="sell-one-btn" onclick="sellOne('${item.id}')">–ü—Ä–æ–¥–∞—Ç—å 1</button>
                            <button class="sell-all-btn" onclick="sellAll('${item.id}')">–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ</button>
                        </div>
                        ` : '<div style="color: #ff9800; font-size: 12px; margin-top: 5px;">‚ö†Ô∏è –î–µ–º–æ –ø—Ä–µ–¥–º–µ—Ç</div>'}
                    </div>
                `;
            }
            
            inventoryDiv.innerHTML = html;
        }

        function sellOne(itemId) {
            const index = state.inventory.findIndex(i => i.id === itemId && !i.isDemo);
            if (index === -1) {
                tg.showPopup({ title: '‚ùå –û—à–∏–±–∫–∞', message: '–ù–µ–ª—å–∑—è –ø—Ä–æ–¥–∞—Ç—å –¥–µ–º–æ-–ø—Ä–µ–¥–º–µ—Ç!', buttons: [{type: 'ok'}] });
                return;
            }
            
            const item = state.inventory[index];
            state.balance += item.price;
            state.inventory.splice(index, 1);
            updateBalance();
            saveState();
            renderInventory();
            tg.showPopup({ title: '–ü—Ä–æ–¥–∞–Ω–æ!', message: `+${item.price} ‚≠ê`, buttons: [{type: 'ok'}] });
        }

        function sellAll(itemId) {
            const itemsToSell = state.inventory.filter(i => i.id === itemId && !i.isDemo);
            if (itemsToSell.length === 0) {
                tg.showPopup({ title: '‚ùå –û—à–∏–±–∫–∞', message: '–ù–µ—Ç –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏', buttons: [{type: 'ok'}] });
                return;
            }
            
            const total = itemsToSell.reduce((sum, i) => sum + i.price, 0);
            state.balance += total;
            state.inventory = state.inventory.filter(i => !(i.id === itemId && !i.isDemo));
            updateBalance();
            saveState();
            renderInventory();
            tg.showPopup({ title: '–ü—Ä–æ–¥–∞–Ω–æ!', message: `+${total} ‚≠ê`, buttons: [{type: 'ok'}] });
        }

        function updateBalance() {
            document.getElementById('balanceDisplay').textContent = state.balance;
            document.getElementById('profileBalance').textContent = state.balance + ' ‚≠ê';
            saveState();
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
        function createSequenceWithResult(resultItem, length) {
            const sequence = [];
            for (let i = 0; i < length; i++) {
                if (i >= 35 && i < 36) {
                    sequence.push(resultItem);
                } else {
                    const rand = Math.random() * 100;
                    if (rand < items.calendar.chance) {
                        sequence.push(items.calendar);
                    } else {
                        sequence.push(items.rose);
                    }
                }
            }
            return sequence;
        }

        async function openCase(isDemo) {
            if (state.isSpinning) return;
            
            const caseData = cases[state.currentCase];
            const totalPrice = caseData.price * state.selectedQuantity;
            
            if (!isDemo && state.balance < totalPrice) {
                tg.showPopup({
                    title: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥',
                    message: `–ù—É–∂–Ω–æ ${totalPrice} ‚≠ê`,
                    buttons: [{type: 'ok'}]
                });
                return;
            }
            
            state.isSpinning = true;
            state.isDemo = isDemo;
            
            if (!isDemo) {
                state.balance -= totalPrice;
                updateBalance();
            }
            
            // –ö–∞–∂–¥—ã–π –∫–µ–π—Å –∫—Ä—É—Ç–∏—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ!
            const results = [];
            for (let i = 0; i < state.selectedQuantity; i++) {
                const rand = Math.random() * 100;
                const result = rand < items.calendar.chance 
                    ? { ...items.calendar, timestamp: Date.now() + i, isDemo }
                    : { ...items.rose, timestamp: Date.now() + i, isDemo };
                results.push(result);
                console.log(`üé≤ –ö–µ–π—Å ${i+1}: –≤—ã–ø–∞–ª ${result.name}`);
            }
            
            state.currentOpenings = results;
            
            const modal = document.getElementById('rouletteModal');
            const multiRoulette = document.getElementById('multiRoulette');
            const resultsList = document.getElementById('resultsList');
            const finalButtons = document.getElementById('finalButtons');
            const rouletteMode = document.getElementById('rouletteMode');
            const sellButton = document.getElementById('sellButton');
            
            modal.classList.add('active');
            multiRoulette.innerHTML = '';
            resultsList.innerHTML = '';
            
            if (isDemo) {
                rouletteMode.style.display = 'inline-block';
                sellButton.style.display = 'none';
                document.getElementById('rouletteTitle').textContent = 'üé≤ –î–µ–º–æ-–æ—Ç–∫—Ä—ã—Ç–∏–µ';
                document.getElementById('rouletteSubtitle').textContent = '–ü—Ä–µ–¥–º–µ—Ç—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è';
            } else {
                rouletteMode.style.display = 'none';
                sellButton.style.display = 'block';
                document.getElementById('rouletteTitle').textContent = 'üé∞ –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–æ–≤';
                document.getElementById('rouletteSubtitle').textContent = '';
            }
            
            finalButtons.style.display = 'none';
            
            const itemWidth = 80;
            const gap = 10;
            const totalItemWidth = itemWidth + gap;
            
            // –°–æ–∑–¥–∞—ë–º —Ä—É–ª–µ—Ç–∫–∏: –¥–ª—è –∫–∞–∂–¥–æ–π —Å–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            for (let i = 0; i < state.selectedQuantity; i++) {
                const rouletteDiv = document.createElement('div');
                rouletteDiv.className = 'single-roulette';
                rouletteDiv.id = `roulette-${i}`;
                
                const track = document.createElement('div');
                track.className = 'roulette-track';
                
                const sequence = createSequenceWithResult(results[i], 70);
                
                sequence.forEach(item => {
                    const itemElement = document.createElement('div');
                    itemElement.className = 'roulette-item';
                    itemElement.style.minWidth = `${itemWidth}px`;
                    itemElement.innerHTML = `
                        <img src="${item.image}" alt="${item.name}">
                        <span>${item.name}</span>
                    `;
                    track.appendChild(itemElement);
                });
                
                rouletteDiv.appendChild(track);
                rouletteDiv.innerHTML += '<div class="roulette-indicator"></div>';
                multiRoulette.appendChild(rouletteDiv);
                
                track.style.transform = `translateY(-50%) translateX(${-totalItemWidth * 20}px)`;
            }
            
            await new Promise(r => setTimeout(r, 100));
            
            for (let i = 0; i < state.selectedQuantity; i++) {
                const track = document.querySelector(`#roulette-${i} .roulette-track`);
                
                const targetIndex = 35;
                const targetPosition = -(targetIndex * totalItemWidth + itemWidth/2);
                const duration = 5000;
                
                track.style.transition = `transform ${duration}ms cubic-bezier(0.15, 0.85, 0.35, 1)`;
                track.style.transform = `translateY(-50%) translateX(${targetPosition}px)`;
            }
            
            await new Promise(r => setTimeout(r, 5200));
            
            results.forEach(r => {
                resultsList.innerHTML += `
                    <div class="result-item ${isDemo ? 'demo' : ''}">
                        <img src="${r.image}" alt="${r.name}">
                        <div class="result-item-info">
                            <div class="result-item-name">${r.emoji} ${r.name}</div>
                            <div class="result-item-price">${r.price} ‚≠ê</div>
                        </div>
                        ${isDemo ? '<span class="demo-label">DEMO</span>' : ''}
                    </div>
                `;
            });
            
            if (!isDemo) {
                console.log('üì¶ –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å:', results.map(r => r.name));
                state.inventory.push(...results);
                state.openedCases += state.selectedQuantity;
                document.getElementById('openedCases').textContent = state.openedCases;
                saveState();
            }
            
            finalButtons.style.display = 'block';
            state.isSpinning = false;
        }

        function sellAllResults() {
            if (state.isDemo) {
                closeRoulette();
                return;
            }
            
            const total = state.currentOpenings.reduce((sum, i) => sum + i.price, 0);
            state.balance += total;
            
            state.currentOpenings.forEach(won => {
                const idx = state.inventory.findIndex(i => i.timestamp === won.timestamp);
                if (idx !== -1) state.inventory.splice(idx, 1);
            });
            
            updateBalance();
            saveState();
            closeRoulette();
            tg.showPopup({ title: '–ü—Ä–æ–¥–∞–Ω–æ!', message: `+${total} ‚≠ê`, buttons: [{type: 'ok'}] });
        }

        function openAgain() {
            closeRoulette();
            setTimeout(() => openCase(state.isDemo), 300);
        }

        function closeRoulette() {
            document.getElementById('rouletteModal').classList.remove('active');
        }

        // –ê–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏ - —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≤–ª–∞–¥–µ–ª—å—Ü–∞
        const ADMIN_PASSWORD = "admin123";
        
        function promptAdminPassword() {
            if (!isOwner()) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏!');
                return;
            }
            
            const password = prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:");
            if (password === ADMIN_PASSWORD) {
                document.getElementById('adminPanel').style.display = 'flex';
                loadAdminData();
            } else if (password !== null) {
                alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");
            }
        }
        
        function toggleAdminPanel() {
            const panel = document.getElementById('adminPanel');
            panel.style.display = panel.style.display === 'none' ? 'flex' : 'none';
        }
        
        function switchAdminTab(tab) {
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.admin-tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`admin${tab.charAt(0).toUpperCase() + tab.slice(1)}`).classList.add('active');
        }
        
        function loadAdminData() {
            if (!isOwner()) return;
            loadUsers();
            loadStats();
            loadCaseForEdit();
        }
        
        function loadUsers() {
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = `
                <div class="user-item">
                    <span class="user-name">${tg.initDataUnsafe?.user?.first_name || '–¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</span>
                    <span class="user-stats">–ë–∞–ª–∞–Ω—Å: ${state.balance} ‚≠ê | –û—Ç–∫—Ä—ã—Ç–æ: ${state.openedCases}</span>
                </div>
            `;
        }
        
        function loadStats() {
            document.getElementById('totalUsers').textContent = '1';
            document.getElementById('totalOpenedCases').textContent = state.openedCases;
            document.getElementById('totalStars').textContent = state.balance;
            
            const topList = document.getElementById('topUsers');
            topList.innerHTML = `
                <div class="top-item">
                    <span><span class="top-rank">1.</span> ${tg.initDataUnsafe?.user?.first_name || '–í—ã'}</span>
                    <span>${state.openedCases} –∫–µ–π—Å–æ–≤</span>
                </div>
            `;
        }
        
        function loadCaseForEdit() {
            if (!isOwner()) return;
            const caseId = document.getElementById('caseSelector').value;
            const caseData = cases[caseId];
            
            document.getElementById('caseName').value = caseData.name;
            document.getElementById('casePrice').value = caseData.price;
            document.getElementById('caseImage').value = 'https://i.postimg.cc/w3wd8bSR/image-2026-02-20-204059171.png';
            
            const itemsList = document.getElementById('itemsList');
            itemsList.innerHTML = '';
            
            caseData.items.forEach((item, index) => {
                itemsList.innerHTML += `
                    <div class="item-edit" id="item-${index}">
                        <div class="form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞:</label>
                            <input type="text" class="item-name" value="${item.name}" data-index="${index}">
                        </div>
                        <div class="form-group">
                            <label>–≠–º–æ–¥–∑–∏:</label>
                            <input type="text" class="item-emoji" value="${item.emoji}" data-index="${index}">
                        </div>
                        <div class="form-group">
                            <label>URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
                            <input type="text" class="item-image" value="${item.image}" data-index="${index}">
                        </div>
                        <div class="form-group">
                            <label>–¶–µ–Ω–∞ (–∑–≤—ë–∑–¥):</label>
                            <input type="number" class="item-price" value="${item.price}" data-index="${index}">
                        </div>
                        <div class="form-group">
                            <label>–®–∞–Ω—Å –≤—ã–ø–∞–¥–µ–Ω–∏—è (%):</label>
                            <input type="number" class="item-chance" value="${item.chance}" data-index="${index}" min="1" max="100">
                        </div>
                        <button class="admin-btn" onclick="removeItem(${index})">‚ùå –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;
            });
        }
        
        function addNewItem() {
            if (!isOwner()) return;
            const itemsList = document.getElementById('itemsList');
            const newIndex = cases.bronze.items.length;
            
            itemsList.innerHTML += `
                <div class="item-edit" id="item-${newIndex}">
                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞:</label>
                        <input type="text" class="item-name" value="–ù–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç" data-index="${newIndex}">
                    </div>
                    <div class="form-group">
                        <label>–≠–º–æ–¥–∑–∏:</label>
                        <input type="text" class="item-emoji" value="üéÅ" data-index="${newIndex}">
                    </div>
                    <div class="form-group">
                        <label>URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
                        <input type="text" class="item-image" value="" data-index="${newIndex}">
                    </div>
                    <div class="form-group">
                        <label>–¶–µ–Ω–∞ (–∑–≤—ë–∑–¥):</label>
                        <input type="number" class="item-price" value="100" data-index="${newIndex}">
                    </div>
                    <div class="form-group">
                        <label>–®–∞–Ω—Å –≤—ã–ø–∞–¥–µ–Ω–∏—è (%):</label>
                        <input type="number" class="item-chance" value="10" data-index="${newIndex}" min="1" max="100">
                    </div>
                    <button class="admin-btn" onclick="removeItem(${newIndex})">‚ùå –£–¥–∞–ª–∏—Ç—å</button>
                </div>
            `;
        }
        
        function removeItem(index) {
            if (!isOwner()) return;
            document.getElementById(`item-${index}`).remove();
        }
        
        function saveCaseChanges() {
            if (!isOwner()) return;
            
            const caseId = document.getElementById('caseSelector').value;
            
            cases[caseId].name = document.getElementById('caseName').value;
            cases[caseId].price = parseInt(document.getElementById('casePrice').value);
            
            const newItems = [];
            const itemElements = document.querySelectorAll('.item-edit');
            
            itemElements.forEach(el => {
                const nameInput = el.querySelector('.item-name');
                const emojiInput = el.querySelector('.item-emoji');
                const imageInput = el.querySelector('.item-image');
                const priceInput = el.querySelector('.item-price');
                const chanceInput = el.querySelector('.item-chance');
                
                if (nameInput && emojiInput && imageInput && priceInput && chanceInput) {
                    let itemId = 'custom_' + Date.now() + Math.random();
                    let newItem = {
                        id: itemId,
                        name: nameInput.value,
                        emoji: emojiInput.value,
                        image: imageInput.value,
                        price: parseInt(priceInput.value),
                        chance: parseInt(chanceInput.value)
                    };
                    newItems.push(newItem);
                    
                    if (!items[itemId]) {
                        items[itemId] = newItem;
                    }
                }
            });
            
            cases[caseId].items = newItems;
            
            alert('‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
            loadCaseForEdit();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateBalance();
        renderInventory();
    </script>
</body>
</html>