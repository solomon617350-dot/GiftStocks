<!DOCTYPE html>
<html>
<head>
    <title>–¢–µ—Å—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</title>
    <meta charset="UTF-8">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f2f5; }
        .stats { background: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; }
        .user { background: white; padding: 10px; margin: 5px 0; border-radius: 5px; display: flex; justify-content: space-between; }
    </style>
</head>
<body>
    <h2>üëë –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º</h2>
    <div class="stats" id="stats">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</div>
    <div id="usersList">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();

        const SERVER_URL = 'https://case-bot-server.onrender.com';
        const OWNER_ID = 7389462195; // —Ç–≤–æ–π ID

        async function checkServer() {
            try {
                // 1. –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                const res = await fetch(`${SERVER_URL}/api/users`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ adminId: OWNER_ID })
                });

                if (!res.ok) {
                    document.getElementById('stats').innerHTML = `‚ùå –û—à–∏–±–∫–∞ ${res.status}: ${res.statusText}`;
                    return;
                }

                const users = await res.json();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                document.getElementById('stats').innerHTML = `
                    <strong>‚úÖ –°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª!</strong><br>
                    –ù–∞–π–¥–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${users.length}
                `;

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                let html = '<h3>–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</h3>';
                if (users.length === 0) {
                    html += '<p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</p>';
                } else {
                    users.forEach(u => {
                        html += `<div class="user">
                            <span>${u.username || 'User'}</span>
                            <span>üí∞ ${u.balance || 0}</span>
                        </div>`;
                    });
                }
                document.getElementById('usersList').innerHTML = html;

            } catch (e) {
                document.getElementById('stats').innerHTML = `‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${e.message}`;
            }
        }

        checkServer();
    </script>
</body>
</html>